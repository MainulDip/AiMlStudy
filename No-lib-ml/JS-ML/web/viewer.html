<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Data Viewer</h1>
    <div id="chartContainer"></div>
    <div id="container"></div>
    
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="../common/js_objects/features.js"></script>
    <script src="../common/constants.js"></script>
    <script src="../common/utils.js"></script>
    <script src="js/display.js"></script>

    <script>
        const {samples, featureNames} = features

        // id: 1, label: "car", student_id: 1663053145814, student_name: "Radu"
        const groups = utils.groupBy(samples, "student_id") // inside utils.js

        // "for in" if applied in object (also on list/array), returns keys, for (let key in arr/obj)
        // for(let value of groups) will not work, as "for of" only works with array/iterable
        for (let student_id in groups) {
            const samples = groups[student_id] // get the value (value is array here) by student_id key
            const studentName = samples[0].student_name // get the first element's student_name props, though all (8 array items) are same, as we arranged them that way
            
            // create the table UI on the given container
            createRow(container, studentName, samples) // comes form js/display.js
            // console.log(student_id)
        }

        // google chart setup
        const options = {
            width: 400,
            height: 400,
            hAxis: {title: featureNames[0]},
            vAxis: {title: featureNames[1]},
            legend: {position: 'none'},
            explorer: {
                maxZoomIn: 0.01,
                actions: ['dragToZoom', 'rightClickToReset']
            }
        }

            // Load the Visualization API and the corechart package.
        google.charts.load('current', {'packages':['corechart']});

        // Set a callback to run when the Google Visualization API is loaded.
        google.charts.setOnLoadCallback(drawChart);

        // Callback that creates and populates a data table
        function drawChart() {

            // Create the data table.
            var data = new google.visualization.DataTable();
            data.addColumn('number', featureNames[0]);
            data.addColumn('number', featureNames[1]);
            data.addColumn({'type': 'string', 'role': 'style'})
            data.addRows(samples.map(s=>[
                ...s.point,
                utils.styles[s.label]
            ]))

            // Instantiate and draw our chart, passing in some options.
            var chart = new google.visualization.ScatterChart(document.getElementById('chartContainer'));
            chart.draw(data, options);
        }

    </script>
</body>
</html>